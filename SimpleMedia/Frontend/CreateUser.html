<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CreateUser/title>
</head>
<body>
    <div id = "error"></div>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password"/>
    <input type="password" id="password2" placeholder="Confirm Password"/>
    <button id="createUser">Create User</button>
    <script>
        document.getElementById("createUser").addEventListener("click", () => {
            let username = document.getElementById("username").value;
            let password = document.getElementById("password").value;
            let password2 = document.getElementById("password2").value;
            if (password == password2) {
                fetch(window.location.href, {
                    method: "POST",
                    body: JSON.stringify({
                        username: username,
                        password: password
                    }),
                    headers: {
                        "Content-Type": "application/json"
                    }
                }).then(function(response){
                    return response.text();
                }).then(function(response){
                    
                    if(response == "Failed"){
                        document.getElementById("error").innerHTML = "Username already exists";
                    } else {
                        document.open('text/html');
                        document.write(response);
                        document.close();
                    }
                });
        } else {
            alert("Passwords do not match");
        }
    });
    </script>
</body>
</html>